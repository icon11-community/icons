<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Folder11 Icon Maker</title>
  <link href="https://cdn.jsdelivr.net/npm/windows-ui-fabric@4.0.2/dist/config/app-config.css" rel="stylesheet" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/windows-ui-fabric@4.0.2/dist/windows-ui.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/windows-ui-fabric@4.0.2/dist/icons/winui-icons.min.css" rel="stylesheet" crossorigin="anonymous">

  <style>
    :root {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --secondary-text-color: #b3b3b3;
      --card-bg-color: #1e1e1e;
      --card-border-color: #333;
      --hover-color: #555;
      --PrimaryColor: #0078D7;
      --PrimaryColorLight: #60CDFF;
    }

    [data-theme="dark"] ::selection {
      color: #ffffff;
      background-color: #2E517E;
    }

    body {
      font-family: 'Segoe UI';
      margin: 15px;
      background: var(--bg-color);
      color: var(--text-color);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .control-group {
      background: var(--card-bg-color);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--card-border-color);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .control-group label {
      display: block;
      margin-bottom: 10px;
      color: var(--text-color);
      font-weight: bold;
    }

    input[type="color"] {
      appearance: none;
      -webkit-appearance: none;
      width: 30px;
      height: 30px;
      border: 2px solid var(--text-color);
      outline: 2px solid var(--card-border-color);
      border-radius: 9%;
      overflow: hidden;
      cursor: pointer;
      padding: 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 0;
      border-radius: 9%;
    }

    input[type="color"]::-webkit-color-swatch {
      border: none;
      border-radius: 9%;
    }

    #object-color-pickers {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .preview {
      background: var(--card-bg-color);
      border-radius: 8px;
      padding: 20px;
      border: 1px solid var(--card-border-color);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      margin-bottom: 30px;
    }

    #svg-container {
      position: relative;
      width: 256px;
      height: 256px;
      margin: 0 auto;
    }

    #custom-svg-container svg {
      cursor: move;
      position: absolute;
      transition: transform 0.1s;
    }

    .previews-container {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 20px;
      padding: 15px;
      background: var(--card-bg-color);
      border-radius: 8px;
      justify-content: center;
    }

    .size-preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border-radius: 4px;
    }

    .size-label {
      font-size: 0.8em;
      color: var(--secondary-text-color);
    }

    .app-range-slider {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Effortless Icon Creation with Folder11</h1>

    <div class="controls">
      <div class="control-group">
        <label>Folder Style</label>
        <div class="app-select-menu" id="folder-style-select" placeholder="Folder Style">
          <select name="Some Name">
            <option value="folder11">Win 11</option>
            <option value="folder10">Win 10 (11 Style)</option>
            <option value="folderMacOs">Mac OS</option>
          </select>
        </div>

        <label>Background Color</label>
        <input type="color" id="background-color-picker" value="#FCBC19">

        <label>Gradient Colors</label>
        <input type="color" id="gradient-color-picker-1" value="#FFE7A2">
        <input type="color" id="gradient-color-picker-2" value="#FFCB3D">

        <label>Save</label>
        <button class="app-btn app-btn-primary" id="save-ico-button">
          <span>Save as ICO</span>
        </button>
        <button class="app-btn" id="save-svg-button">
          <span>Save as SVG</span>
        </button>
      </div>

      <div class="control-group">
        <label>Add Object</label>
        <input type="file" id="file-input" accept="image/*">

        <label>Size</label>
        <div class="app-range-slider">
          <input type="range" id="size-range" min="10" max="300" step="1" value="150">
        </div>

        <label>Opacity</label>
        <div class="app-range-slider">
          <input type="range" id="opacity-range" min="0" max="1" step="0.1" value="1">
        </div>

        <div class="app-accordion">
          <div class="app-accordion-header" data-win-toggle="collapse" data-win-target="#Others" aria-expanded="false" aria-controls="Others">
            <div class="app-accordion-title">
              <span>Others</span>
            </div>
          </div>
          <div class="app-accordion-panel" id="Others">
            <label>Offset</label>
            <div class="app-range-slider">
              <input type="range" id="offset-x" min="-350" max="350" step="1" value="0">
              <input type="range" id="offset-y" min="-350" max="350" step="1" value="0">
            </div>

            <label>Skew</label>
            <div class="app-range-slider">
              <input type="range" id="skew-x" min="-150" max="150" step="1" value="0.1">
              <input type="range" id="skew-y" min="-150" max="150" step="1" value="0.1">
            </div>

            <label class="app-switch">
              <label>Drop Shadow</label>
              <input type="checkbox" id="drop-shadow-toggle" />
              <div class="app-switch-view"></div>
              <span class="app-switch-label" style="width: 28px;"></span>
            </label>
          </div>
        </div>
      </div>

      <div class="control-group">
        <div class="app-accordion">
          <div class="app-accordion-header" data-win-toggle="collapse" data-win-target="#Colors" aria-expanded="false" aria-controls="Colors">
            <div class="app-accordion-title">
              <span>Colors</span>
            </div>
          </div>
          <div class="app-accordion-panel" id="Colors">
            <div id="object-color-pickers"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="preview">
      <div id="svg-container"></div>
      <div class="previews-container" id="size-previews"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/windows-ui-fabric@4.0.1/dist/windows-ui.min.js" crossorigin="anonymous"></script>
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      let currentFileType = 'svg';
      let offsetX = 0;
      let offsetY = 0;
      let skewX = 0;
      let skewY = 0;
  
      const folder11SVG = `
        <svg width="256" height="256" viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_16_132)" id="base-svg-group">
            <path id="back-svg-group" fill-rule="evenodd" clip-rule="evenodd" d="M104.425 42.3784C100.056 37.0733 93.5437 34 86.6712 34H29C22.3726 34 17 39.3726 17 46V58.1371V68.2V160C17 166.627 22.3726 172 29 172H229C235.627 172 241 166.627 241 160V70.1371C241 63.5097 235.627 58.1371 229 58.1371H117.404L104.425 42.3784Z" fill="#FCBC19"/>
            <mask id="mask0_16_132" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="17" y="34" width="224" height="138">
              <path id="back-svg-group" fill-rule="evenodd" clip-rule="evenodd" d="M104.425 42.3784C100.056 37.0733 93.5437 34 86.6712 34H29C22.3726 34 17 39.3726 17 46V58.1371V68.2V160C17 166.627 22.3726 172 29 172H229C235.627 172 241 166.627 241 160V70.1371C241 63.5097 235.627 58.1371 229 58.1371H117.404L104.425 42.3784Z" fill="url(#paint0_linear_16_132)"/>
            </mask>
            <g mask="url(#mask0_16_132)">
              <g style="mix-blend-mode:multiply" filter="url(#filter0_f_16_132)">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M92.789 74C97.7642 74 102.605 72.3868 106.586 69.4024L116.459 62H229C235.627 62 241 67.3726 241 74V108V160C241 166.627 235.627 172 229 172H29C22.3726 172 17 166.627 17 160L17 108V86C17 79.3726 22.3726 74 29 74H87H92.789Z" fill="black" fill-opacity="0.3"/>
              </g>
            </g>
            <path id="front-svg-group" filter="url(#filter1_ii_16_132)" fill-rule="evenodd" clip-rule="evenodd" d="M92.789 74C97.7642 74 102.605 72.3868 106.586 69.4024L116.459 62H229C235.627 62 241 67.3726 241 74V108V198C241 204.627 235.627 210 229 210H29C22.3726 210 17 204.627 17 198L17 108V86C17 79.3726 22.3726 74 29 74H87H92.789Z" fill="url(#paint1_linear_16_132)"/>
          </g>
          <defs>
            <filter id="filter0_f_16_132" x="-20" y="25" width="298" height="184" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
              <feGaussianBlur stdDeviation="18.5" result="effect1_foregroundBlur_16_132"/>
            </filter>
            <filter id="filter1_ii_16_132" x="17" y="62" width="224" height="148" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dy="4"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
              <feBlend mode="normal" in2="shape" result="effect1_innerShadow_16_132"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dy="-4"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.9 0"/>
              <feBlend mode="soft-light" in2="effect1_innerShadow_16_132" result="effect2_innerShadow_16_132"/>
            </filter>
            <linearGradient id="paint0_linear_16_132" x1="17" y1="34" x2="197.768" y2="215.142" gradientUnits="userSpaceOnUse">
              <stop stop-color="#FFE7A2"/>
              <stop offset="1" stop-color="#FFCB3D"/>
            </linearGradient>
            <linearGradient id="paint1_linear_16_132" x1="17" y1="62" x2="241" y2="210" gradientUnits="userSpaceOnUse">
              <stop stop-color="#FFE7A2"/>
              <stop offset="0.953125" stop-color="#FFCB3D"/>
            </linearGradient>
          </defs>
        </svg>
      `;
      const folderMacOs = `
      <svg width="256" height="256" viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g filter="url(#filter0_dddd_1_2)">
          <mask id="mask0_1_2" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="10" y="31" width="236" height="210">
            <path d="M39.3 228.5H216.7C226.781 228.5 231.821 228.5 235.672 226.538C239.059 224.812 241.812 222.059 243.538 218.672C245.5 214.821 245.5 209.781 245.5 199.7V78.3C245.5 68.2191 245.5 63.1786 243.538 59.3282C241.812 55.9413 239.059 53.1876 235.672 51.4619C231.821 49.5 226.781 49.5 216.7 49.5H119.375C114 49.5 107.125 49 100.375 43.875C93.625 38.75 99.375 43.125 92.25 37.625C85.125 32.125 81.4915 31 75.25 31H39.3C29.2191 31 24.1786 31 20.3282 32.9619C16.9413 34.6876 14.1876 37.4413 12.4619 40.8282C10.5 44.6786 10.5 49.7191 10.5 59.8V199.7C10.5 209.781 10.5 214.821 12.4619 218.672C14.1876 222.059 16.9413 224.812 20.3282 226.538C24.1786 228.5 29.2191 228.5 39.3 228.5Z" fill="url(#paint0_linear_1_2)"/>
          </mask>
          <g mask="url(#mask0_1_2)">
            <path id="back-svg-group" d="M39.3 228.5H216.7C226.781 228.5 231.821 228.5 235.672 226.538C239.059 224.812 241.812 222.059 243.538 218.672C245.5 214.821 245.5 209.781 245.5 199.7V78.3C245.5 68.2191 245.5 63.1786 243.538 59.3282C241.812 55.9413 239.059 53.1876 235.672 51.4619C231.821 49.5 226.781 49.5 216.7 49.5H119.375C114 49.5 107.125 49 100.375 43.875C93.625 38.75 99.375 43.125 92.25 37.625C85.125 32.125 81.4915 31 75.25 31H39.3C29.2191 31 24.1786 31 20.3282 32.9619C16.9413 34.6876 14.1876 37.4413 12.4619 40.8282C10.5 44.6786 10.5 49.7191 10.5 59.8V199.7C10.5 209.781 10.5 214.821 12.4619 218.672C14.1876 222.059 16.9413 224.812 20.3282 226.538C24.1786 228.5 29.2191 228.5 39.3 228.5Z" fill="#FCBC19"/>
            <g filter="url(#filter1_dii_1_2)">
              <rect id="front-svg-group" x="10.5" y="64.5" width="235" height="164" rx="18" fill="url(#paint1_linear_16_132)"/>
            </g>
            <g filter="url(#filter2_di_1_2)">
              <rect x="10.5" y="204" width="235" height="4.5" fill="white" fill-opacity="0.1" shape-rendering="crispEdges"/>
            </g>
            <g filter="url(#filter3_di_1_2)">
              <rect x="10.5" y="213.25" width="235" height="4.5" fill="white" fill-opacity="0.1" shape-rendering="crispEdges"/>
            </g>
          </g>
        </g>
        <g id="custom-svg-container"></g>
        <defs>
          <filter id="filter0_dddd_1_2" x="2.5" y="27" width="251" height="225.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="4"/>
            <feGaussianBlur stdDeviation="4"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_2"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="3"/>
            <feGaussianBlur stdDeviation="3"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.21 0"/>
            <feBlend mode="normal" in2="effect1_dropShadow_1_2" result="effect2_dropShadow_1_2"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="2"/>
            <feGaussianBlur stdDeviation="2"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"/>
            <feBlend mode="normal" in2="effect2_dropShadow_1_2" result="effect3_dropShadow_1_2"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="0.5"/>
            <feGaussianBlur stdDeviation="0.5"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
            <feBlend mode="normal" in2="effect3_dropShadow_1_2" result="effect4_dropShadow_1_2"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect4_dropShadow_1_2" result="shape"/>
          </filter>
          <filter id="filter1_dii_1_2" x="-5.5" y="44.5" width="267" height="196" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="-4"/>
            <feGaussianBlur stdDeviation="8"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0.5 0"/>
            <feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_1_2"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_2" result="shape"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="-8"/>
            <feGaussianBlur stdDeviation="16"/>
            <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0.2 0"/>
            <feBlend mode="multiply" in2="shape" result="effect2_innerShadow_1_2"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="1.5"/>
            <feGaussianBlur stdDeviation="0.75"/>
            <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
            <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.15 0"/>
            <feBlend mode="normal" in2="effect2_innerShadow_1_2" result="effect3_innerShadow_1_2"/>
          </filter>
          <filter id="filter2_di_1_2" x="9" y="202.5" width="238" height="9" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="1.5"/>
            <feGaussianBlur stdDeviation="0.75"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0.1 0"/>
            <feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_1_2"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_2" result="shape"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="-1.5"/>
            <feGaussianBlur stdDeviation="0.75"/>
            <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.318802 0 0 0 0 0.318802 0 0 0 0 0.318802 0 0 0 0.1 0"/>
            <feBlend mode="multiply" in2="shape" result="effect2_innerShadow_1_2"/>
          </filter>
          <filter id="filter3_di_1_2" x="9" y="211.75" width="238" height="9" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="1.5"/>
            <feGaussianBlur stdDeviation="0.75"/>
            <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0 0.317647 0 0 0 0.1 0"/>
            <feBlend mode="multiply" in2="shape" result="effect2_innerShadow_1_2"/>
          </filter>
          <linearGradient id="paint0_linear_1_2" x1="128" y1="43" x2="128" y2="240.5" gradientUnits="userSpaceOnUse">
            <stop stop-color="#E4E4E4"/>
            <stop offset="0.229272" stop-color="#D8D8D8"/>
          </linearGradient>
          <linearGradient id="paint1_linear_16_132" x1="128" y1="64.5" x2="128" y2="228.5" gradientUnits="userSpaceOnUse">
            <stop stop-color="#FFE7A2"/>
            <stop offset="1" stop-color="#FFCB3D"/>
          </linearGradient>
        </defs>
      </svg>
      `;
      const folder10SVG = `
        <svg width="256" height="256" viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path id="back-svg-group" fill-rule="evenodd" clip-rule="evenodd" d="M182.151 138.967C186.488 142.517 189 147.808 189 153.392V200.25C189 205.635 184.608 210 179.19 210H169.269H161.043L54.8095 210C49.3922 210 44.9999 205.635 44.9999 200.25L44.9999 37.75C44.9999 32.3656 49.3922 28 54.8095 28L159.459 28C164.877 28 169.269 32.3656 169.269 37.75L169.269 128.422L182.151 138.967Z" fill="#FCBC19"/>
          <g id="custom-svg-container"></g>
          <mask id="mask0_16_131" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="45" y="28" width="144" height="182">
            <path id="back-svg-group-mask" fill-rule="evenodd" clip-rule="evenodd" d="M181.776 138.967C186.101 142.517 188.607 147.808 188.607 153.392V200.25C188.607 205.635 184.227 210 178.824 210H168.929H160.726L54.7828 210C49.3802 210 44.9999 205.635 44.9999 200.25L44.9999 37.75C44.9999 32.3656 49.3802 28 54.7828 28L159.146 28C164.549 28 168.929 32.3656 168.929 37.75L168.929 128.422L181.776 138.967Z" fill="url(#paint0_linear_16_132)"/>
          </mask>
          <g mask="url(#mask0_16_131)">
            <g style="mix-blend-mode:multiply" filter="url(#filter0_f_16_131)">
              <path id="front-svg-group" fill-rule="evenodd" clip-rule="evenodd" d="M106.926 148.421C106.926 144.379 108.383 140.446 111.078 137.211L117.762 129.19L117.762 37.75C117.762 32.3656 112.911 28 106.926 28H76.223L29.2655 28C23.2812 28 18.4292 32.3656 18.4292 37.75L18.4292 200.25C18.4292 205.635 23.2812 210 29.2655 210L76.223 210H96.0896C102.074 210 106.926 205.635 106.926 200.25L106.926 153.125V148.421Z" fill="#585757" fill-opacity="0.3"/>
            </g>
          </g>
          <g filter="url(#filter1_ii_16_131)">
            <path d="M93.9016 168C91.9908 169.742 90.2185 175.239 90.2185 179.281V237.5C90.2185 242.885 86.7786 243.172 82.5354 239.857L52.6831 216.003C48.4401 212.688 44.9999 205.635 44.9999 200.25V37.7367C45.0026 35.7774 45.5868 33.9535 46.5902 32.4263C48 30.5 49 31 52.6831 34.0027L86.2185 60.8596C90.4617 64.1748 93.9016 71.2279 93.9016 76.6123L93.9016 168Z" fill="url(#paint1_linear_16_132)"/>
          </g>
          <defs>
            <filter id="filter0_f_16_131" x="-18.5708" y="-9" width="173.333" height="256" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
              <feGaussianBlur stdDeviation="18.5" result="effect1_foregroundBlur_16_131"/>
            </filter>
            <filter id="filter1_ii_16_131" x="44.9999" y="31.2841" width="48.9017" height="210.733" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="2" dy="2"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
              <feBlend mode="normal" in2="shape" result="effect1_innerShadow_16_131"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dx="-2" dy="-2"/>
              <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.9 0"/>
              <feBlend mode="soft-light" in2="effect1_innerShadow_16_131" result="effect2_innerShadow_16_131"/>
            </filter>
            <linearGradient id="paint0_linear_16_132" x1="188.607" y1="210" x2="41.4285" y2="62.6315" gradientUnits="userSpaceOnUse">
              <stop stop-color="#FFE7A2"/>
              <stop offset="1" stop-color="#FFCB3D"/>
            </linearGradient>
            <linearGradient id="paint1_linear_16_132" x1="47.5" y1="27.5" x2="124" y2="43.4679" gradientUnits="userSpaceOnUse">
              <stop stop-color="#FFE7A2"/>
              <stop offset="1" stop-color="#FFCB3D"/>
            </linearGradient>
          </defs>
        </svg>
      `;

      const initializeColorControls = () => {
  document.getElementById('background-color-picker').addEventListener('input', (e) => {
    const svgElement = document.querySelector('#back-svg-group');
    if (svgElement) {
      svgElement.setAttribute('fill', e.target.value);
    }
  });

  document.getElementById('gradient-color-picker-1').addEventListener('input', (e) => {
    document.querySelector('#paint1_linear_16_132 stop:first-child').setAttribute('stop-color', e.target.value);
  });

  document.getElementById('gradient-color-picker-2').addEventListener('input', (e) => {
    document.querySelector('#paint1_linear_16_132 stop:last-child').setAttribute('stop-color', e.target.value);
  });
};

      const parseColor = (colorValue) => {
        if (!colorValue || colorValue === 'none' || colorValue.startsWith('url(#')) return null;
        const ctx = document.createElement('canvas').getContext('2d');
        ctx.fillStyle = colorValue;
        return ctx.fillStyle.toLowerCase();
      };

      const buildColorMap = (svgGroup) => {
        const colorMap = {};

        const traverse = (element) => {
          const fill = parseColor(element.getAttribute('fill'));
          if (fill) {
            colorMap[fill] = colorMap[fill] || [];
            colorMap[fill].push({ element, attribute: 'fill' });
          }

          const stroke = parseColor(element.getAttribute('stroke'));
          if (stroke) {
            colorMap[stroke] = colorMap[stroke] || [];
            colorMap[stroke].push({ element, attribute: 'stroke' });
          }

          Array.from(element.children).forEach(traverse);
        };

        traverse(svgGroup);
        return colorMap;
      };

      const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const colorPickersContainer = document.getElementById('object-color-pickers');
        const isSVG = file.type === 'image/svg+xml';

        const customContainer = document.querySelector('#custom-svg-container');
        customContainer.innerHTML = '';
        colorPickersContainer.innerHTML = '';

        const saveSvgButton = document.getElementById('save-svg-button');
        saveSvgButton.disabled = !isSVG;

        if (isSVG) {
          currentFileType = 'svg';
          const reader = new FileReader();
          reader.onload = (event) => {
            const parser = new DOMParser();
            const svgDoc = parser.parseFromString(event.target.result, 'image/svg+xml');
            const newSVG = svgDoc.documentElement;

            const wrapperGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            wrapperGroup.classList.add('custom-svg');

            while (newSVG.firstChild) {
              wrapperGroup.appendChild(newSVG.firstChild);
            }

            customContainer.appendChild(wrapperGroup);

            const colorMap = buildColorMap(wrapperGroup);
            Object.keys(colorMap).forEach((color) => {
              const wrapper = document.createElement('div');
              wrapper.classList.add('app-range-slider');
              wrapper.style.display = 'flex';
              wrapper.style.alignItems = 'center';
              wrapper.style.gap = '10px';
              wrapper.style.marginBottom = '8px';

              const input = document.createElement('input');
              input.type = 'color';
              input.value = color;
              input.dataset.originalColor = color;

              const opacitySlider = document.createElement('input');
              opacitySlider.type = 'range';
              opacitySlider.min = '0';
              opacitySlider.max = '1';
              opacitySlider.step = '0.1';
              opacitySlider.value = '1';
              opacitySlider.style.width = '100px';

              wrapper.appendChild(input);
              wrapper.appendChild(opacitySlider);
              
              colorPickersContainer.appendChild(wrapper);

              input.addEventListener('input', (e) => {
                const newColor = e.target.value;
                const originalColor = e.target.dataset.originalColor;
                colorMap[originalColor].forEach(({ element, attribute }) => {
                  element.setAttribute(attribute, newColor);
                });
                updateSizePreviews();
              });

              opacitySlider.addEventListener('input', (e) => {
                const opacity = e.target.value;
                const originalColor = input.dataset.originalColor;
                colorMap[originalColor].forEach(({ element }) => {
                  element.style.opacity = opacity;
                });
                updateSizePreviews();
              });

              wrapper.appendChild(input);
              wrapper.appendChild(opacitySlider);
              colorPickersContainer.appendChild(wrapper);
            });

            handleSizeChange({ target: document.getElementById('size-range') });
            updateSizePreviews();
          };
          reader.readAsText(file);
        } else {
          currentFileType = 'png';
          const reader = new FileReader();
          reader.onload = (event) => {
            const img = document.createElementNS('http://www.w3.org/2000/svg', 'image');
            img.setAttribute('href', event.target.result);
            img.setAttribute('width', '100%');
            img.setAttribute('height', '100%');
            img.setAttribute('preserveAspectRatio', 'xMidYMid meet');
            img.classList.add('custom-image');

            customContainer.appendChild(img);
            handleSizeChange({ target: document.getElementById('size-range') });
          };
          reader.readAsDataURL(file);
        }

        colorPickersContainer.style.display = isSVG ? 'flex' : 'none';
      };

      const handleSizeChange = (e) => {
        const desiredFraction = e.target.value / 100;
        let referenceGroup;

        if (currentFileType === 'svg') {
          const selectedStyle = document.getElementById('folder-style-select').value;
          referenceGroup = selectedStyle === 'folder10'
            ? document.getElementById('back-svg-group')
            : document.getElementById('front-svg-group');

          const bbox = referenceGroup.getBBox();
          const centerX = bbox.x + bbox.width / 2;
          const centerY = bbox.y + bbox.height / 2;

          document.querySelectorAll('.custom-svg').forEach(group => {
            const groupBBox = group.getBBox();
            const scaleX = (bbox.width * desiredFraction) / groupBBox.width;
            const scaleY = (bbox.height * desiredFraction) / groupBBox.height;
            const scale = Math.min(scaleX, scaleY);

            const translateX = centerX - (groupBBox.width * scale) / 2 + offsetX;
            const translateY = centerY - (groupBBox.height * scale) / 2 + offsetY;

            // Apply translate and scale to the parent group
            group.setAttribute('transform', `translate(${translateX} ${translateY}) scale(${scale})`);

            // Apply skew to the child elements
            group.querySelectorAll('*').forEach(child => {
              child.setAttribute('transform', `skewX(${skewX}) skewY(${skewY})`);
            });
          });
        } else {
          const images = document.querySelectorAll('.custom-image');
          const selectedStyle = document.getElementById('folder-style-select').value;
          referenceGroup = selectedStyle === 'folder10'
            ? document.getElementById('back-svg-group')
            : document.getElementById('front-svg-group');

          if (referenceGroup) {
            const bbox = referenceGroup.getBBox();
            const centerX = bbox.x + bbox.width / 2;
            const centerY = bbox.y + bbox.height / 2;

            images.forEach(img => {
              const scaleX = (bbox.width * desiredFraction) / 256;
              const scaleY = (bbox.height * desiredFraction) / 256;
              const scale = Math.min(scaleX, scaleY);

              const translateX = centerX - (256 * scale) / 2 + offsetX;
              const translateY = centerY - (256 * scale) / 2 + offsetY;

              img.setAttribute('width', 256 * scale);
              img.setAttribute('height', 256 * scale);
              img.setAttribute('x', translateX);
              img.setAttribute('y', translateY);

              // Apply skew using CSS transform
              img.style.transform = `skew(${skewX}deg, ${skewY}deg)`;
            });
          }
        }
      };

      const handleOpacityChange = (e) => {
        const opacity = parseFloat(e.target.value);
        if (currentFileType === 'svg') {
          document.querySelectorAll('.custom-svg').forEach(svg => {
            svg.style.opacity = opacity;
          });
        } else {
          document.querySelectorAll('.custom-image').forEach(img => {
            img.style.opacity = opacity;
          });
        }
      };

      const handleDropShadowToggle = (e) => {
        const isChecked = e.target.checked;
        if (currentFileType === 'svg') {
          document.querySelectorAll('.custom-svg').forEach(svg => {
            svg.style.filter = isChecked ? 'drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.5))' : 'none';
          });
        } else {
          document.querySelectorAll('.custom-image').forEach(img => {
            img.style.filter = isChecked ? 'drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.5))' : 'none';
          });
        }
      };

      const handleOffsetChange = () => {
        offsetX = parseFloat(document.getElementById('offset-x').value) || 0;
        offsetY = parseFloat(document.getElementById('offset-y').value) || 0;
        handleSizeChange({ target: document.getElementById('size-range') });
      };

      const handleSkewChange = () => {
        skewX = parseFloat(document.getElementById('skew-x').value) || 0;
        skewY = parseFloat(document.getElementById('skew-y').value) || 0;
        handleSizeChange({ target: document.getElementById('size-range') });
      };

      const updateSizePreviews = () => {
        const sizes = [64, 48, 40, 32, 24, 20, 16];
        const container = document.getElementById('size-previews');
        const mainSVG = document.querySelector('svg');
        const clonedSVG = mainSVG.cloneNode(true);

        container.innerHTML = '';

        sizes.forEach(size => {
          const wrapper = document.createElement('div');
          wrapper.className = 'size-preview';

          const svgClone = clonedSVG.cloneNode(true);
          svgClone.setAttribute('width', size);
          svgClone.setAttribute('height', size);

          const label = document.createElement('div');
          label.className = 'size-label';
          label.textContent = `${size}x${size}`;

          wrapper.appendChild(svgClone);
          wrapper.appendChild(label);
          container.appendChild(wrapper);
        });
      };

      const sizeRange = document.getElementById('size-range');
      const opacityRange = document.getElementById('opacity-range');
      const initializeEventListeners = () => {
        initializeColorControls();
        document.getElementById('file-input').addEventListener('change', handleFileUpload);
        document.getElementById('size-range').addEventListener('input', handleSizeChange);
        document.getElementById('opacity-range').addEventListener('input', handleOpacityChange);
        document.getElementById('drop-shadow-toggle').addEventListener('change', handleDropShadowToggle);
        document.getElementById('offset-x').addEventListener('input', handleOffsetChange);
        document.getElementById('offset-y').addEventListener('input', handleOffsetChange);
        document.getElementById('skew-x').addEventListener('input', handleSkewChange);
        document.getElementById('skew-y').addEventListener('input', handleSkewChange);

        const observers = [
          'background-color-picker',
          'gradient-color-picker-1',
          'gradient-color-picker-2',
          'size-range',
          'offset-x',
          'offset-y',
          'skew-x',
          'skew-y',
          'opacity-range',
          'drop-shadow-toggle'
        ];

        observers.forEach(id => {
          document.getElementById(id).addEventListener('input', () => {
            setTimeout(updateSizePreviews, 100);
          });
        });

        updateSizePreviews();
      };

      const saveAsICO = async () => {
        const svgElement = document.querySelector('svg');
        const serializer = new XMLSerializer();
        const svgString = serializer.serializeToString(svgElement);
        const sizes = [256, 64, 48, 40, 32, 24, 20, 16];

        const svgToPng = async (svg, size) => {
          return new Promise((resolve) => {
            const img = new Image();
            img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svg)));
            img.onload = () => {
              const canvas = document.createElement('canvas');
              canvas.width = size;
              canvas.height = size;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(img, 0, 0, size, size);
              resolve(canvas.toDataURL('image/png'));
            };
          });
        };

        const pngBuffers = await Promise.all(sizes.map(async (size) => {
          const pngData = await svgToPng(svgString, size);
          const byteString = atob(pngData.split(',')[1]);
          const buffer = new Uint8Array(byteString.length);
          for (let i = 0; i < byteString.length; i++) {
            buffer[i] = byteString.charCodeAt(i);
          }
          return buffer;
        }));

        const icoHeader = new Uint8Array([
          0x00, 0x00, 0x01, 0x00, sizes.length & 0xff, 0x00
        ]);

        let offset = icoHeader.byteLength + (sizes.length * 16);
        const entries = [];
        const images = [];

        for (let i = 0; i < sizes.length; i++) {
          const size = sizes[i];
          const buffer = pngBuffers[i];
          entries.push(new Uint8Array([
            size === 256 ? 0 : size, size === 256 ? 0 : size,
            0, 0, 1, 0, 32, 0,
            buffer.length & 0xff, (buffer.length >> 8) & 0xff, (buffer.length >> 16) & 0xff, (buffer.length >> 24) & 0xff,
            offset & 0xff, (offset >> 8) & 0xff, (offset >> 16) & 0xff, (offset >> 24) & 0xff
          ]));
          images.push(buffer);
          offset += buffer.length;
        }

        const icoData = new Uint8Array(
          icoHeader.byteLength +
          entries.reduce((a, b) => a + b.byteLength, 0) +
          images.reduce((a, b) => a + b.byteLength, 0)
        );

        icoData.set(icoHeader, 0);
        let pos = icoHeader.byteLength;
        entries.forEach(entry => {
          icoData.set(entry, pos);
          pos += entry.byteLength;
        });
        images.forEach(image => {
          icoData.set(image, pos);
          pos += image.byteLength;
        });

        const blob = new Blob([icoData], { type: 'image/x-icon' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'icon.ico';
        link.click();
      };

      const saveAsSVG = () => {
        const svgElement = document.querySelector('svg');
        const serializer = new XMLSerializer();
        const svgString = serializer.serializeToString(svgElement);
        const blob = new Blob([svgString], { type: 'image/svg+xml' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'icon.svg';
        link.click();
      };

      const handleFolderStyleChange = (e) => {
        const selectedStyle = e.target.value;
        const svgContainer = document.querySelector('#svg-container');
        // Reset the SVG container
        svgContainer.innerHTML = '';

        // Reset color pickers and other controls
        document.getElementById('file-input').value = '';
        document.getElementById('offset-x').value = 0;
        document.getElementById('offset-y').value = 0;
        document.getElementById('skew-x').value = 0;
        document.getElementById('skew-y').value = 0;
        document.getElementById('background-color-picker').value = '#FCBC19';
        document.getElementById('gradient-color-picker-1').value = '#FFE7A2';
        document.getElementById('gradient-color-picker-2').value = '#FFCB3D';
        document.getElementById('size-range').value = 150;
        document.getElementById('opacity-range').value = 1;
        document.getElementById('drop-shadow-toggle').checked = false;

        // Reset custom SVG container
        const customContainer = document.querySelector('#custom-svg-container');

        // Reset color pickers container
        const colorPickersContainer = document.getElementById('object-color-pickers');
        colorPickersContainer.innerHTML = '';
        colorPickersContainer.style.display = 'none';
  
        if (selectedStyle === 'folder11') {
            svgContainer.innerHTML = folder11SVG;
          } else if (selectedStyle === 'folder10') {
            svgContainer.innerHTML = folder10SVG;
          } else if (selectedStyle === 'folderMacOs') {
            svgContainer.innerHTML = folderMacOs;
          }
        initializeEventListeners();
        updateSizePreviews();
      };

      // Initialize the application with the default folder style
      document.querySelector('#svg-container').innerHTML = folder11SVG;
      initializeEventListeners();
      document.getElementById('save-ico-button').addEventListener('click', saveAsICO);
      document.getElementById('save-svg-button').addEventListener('click', saveAsSVG);
      document.getElementById('folder-style-select').addEventListener('change', handleFolderStyleChange);
    });
  </script>
</body>
</html>
